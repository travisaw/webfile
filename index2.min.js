function refreshFiles(){loadFiles(function(){labelSuccess("Files Refreshed"),$("#fileToUpload").val(""),updateFileNameLbl()})}function loadFiles(e){$.get("getfiles",function(e,l){populateFilesTable(e)}),e()}function populateFilesTable(e){$("#tblFiles").find("tr:not(:first)").remove(),$.each(e,function(e,l){var t=new Date(l.modified),o="<tr>";o+="<td>"+l.name+"</td>",o+="<td>"+l.size+"</td>",o+="<td>"+t.toLocaleString()+"</td>",o+='<td><a class="uploadbutton" href="'+l.path+'" download>Download</a></td>',o+="<td><button onclick=\"deleteFile('"+l.name+"')\">Delete</button></td>",o+="</tr>",$("#tblFiles").append(o)})}function deleteFile(e){e={file:e};$.ajax({type:"POST",url:"deletefile",data:e,success:function(e){loadFiles(function(){labelSuccess(e.message)})},error:function(e){e.responseJSON?labelError(e.responseJSON.message):labelError("Unknown error encountered")},dataType:"json"})}function labelSuccess(e){$("#lblStatus").removeClass("lblfail").addClass("lblsuccess"),$("#lblStatus").html(e),setTimeout(function(){$("#lblStatus").html("")},5e3)}function labelError(e){$("#lblStatus").removeClass("lblsuccess").addClass("lblfail"),$("#lblStatus").html(e),setTimeout(function(){$("#lblStatus").html("")},5e3)}function updateFileNameLbl(){var e=$("#fileToUpload")[0].files[0];void 0!==e?$("#lblFileName").text(e.name):($("#lblFileName").empty(),$("#fileprogress")[0].max=1,$("#fileprogress")[0].value=0,$("#fileprogress").hide("slow"))}function uploadFile(){var e,l;document.getElementById("fileToUpload").files[0]?(e=document.getElementById("fileToUpload").files[0],l=new FileReader,$("#fileprogress").show(),l.readAsDataURL(e),l.onloadend=postFile):labelError("Select file to upload!")}function postFile(e){var l=document.getElementById("fileToUpload").files[0],l={data:e.target.result,name:l.name,size:l.size,modified:l.lastModified,type:l.type};$.ajax({xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){e.lengthComputable&&($("#fileprogress")[0].max=e.total,$("#fileprogress")[0].value=e.loaded)},!1),e},type:"POST",url:"uploadfile",data:l,success:function(e){labelSuccess(e.message),$("#fileToUpload").val(""),loadFiles(function(){updateFileNameLbl()})},error:function(e){e.responseJSON?labelError(e.responseJSON.message):labelError("Unknown error encountered")},dataType:"json"})}$(document).ready(function(){loadFiles(function(){})});
